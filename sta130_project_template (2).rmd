
---
title: "The effect of Time on Number of Auto Thefts"
author: "Stephanie Cristea, Nicole Sin, Johnson Vo, Lily Zuo, TUT107, group number: 1"
subtitle: "Based on Auto Thefts data from Toronto provided by the the Toronto POlice Service and from the years 2014-2018"
output:
  ioslides_presentation: default
  widescreen: yes
  transition: faster
---


```{r, echo=FALSE, message=FALSE, warning=FALSE}
# echo=FALSE will stop the code chunk from appearing in the knit document
# warning=FALSE and message=FALSE will stop R messages from appearing in the knit document
library(tidyverse)
auto_thefts <- read.csv("auto_thefts.csv")

neighbourhood <- auto_thefts %>% select(Index_, occurrencemonth, occurrencedayofweek, occurrencehour)%>% mutate(season = ifelse((occurrencemonth == 'March'| occurrencemonth == 'April'| occurrencemonth == 'May'| occurrencemonth == 'June'| occurrencemonth == 'July'| occurrencemonth == 'August'), yes = "Spring_Summer", no = "Fall_Winter"))%>%
  mutate(week_end_or_day = ifelse(occurrencedayofweek == "Sunday"| occurrencedayofweek == "Saturday", yes = "Weekend", no = "Weekday")) %>%
  mutate(time_of_day= ifelse(occurrencehour >= 18|occurrencehour <= 6, yes = "Night", no= "Day"))
```

## Goals

- Analyze the importance of time with regard to the number of auto thefts
- Determine when the public should take better precautions protecting their cars 
- Determine when police officers should be more prepared for auto-thefts based on when they take place more often


## Questions of Analysis

1. Does the number of auto thefts show a significant correlation depending on whether it is a weekend vs a weekday?
2. Does the number of autothefts show a significant correlation depending on whether it is during the day or the night?
3. Does the number of autothefts show a significant correlation depending on whether it is during the Spring/Summer or Winter/Fall?

# Data Visualization

---

```{r, echo=FALSE, warning=FALSE, fig.height = 3, fig.width= 4, .columns-2}
neighbourhood %>% ggplot(aes(x = occurrencemonth, colour = season)) + geom_bar() + ggtitle("Number of Auto Thefts Depending on the Months \nof the Year") +
  labs (x = "Month", y = "Number of Auto Thefts") + coord_flip()
neighbourhood %>% ggplot(aes(x = occurrencedayofweek, colour = week_end_or_day)) + geom_bar() + ggtitle("Number of Auto Thefts Depending \non the Day of the Week")+
  labs (x ="Day of the Week", y = "Number of Auto Thefts") + coord_flip()
neighbourhood %>% ggplot(aes(x = occurrencehour, colour = time_of_day)) + geom_bar() + ggtitle("Number of Auto Thefts Depending on the Time \nof the Day")+
  labs (x = "Time of the day (by hour)", y = "Number of Auto Thefts")
```

## Data Summary
The following variables were created to address our questions of analysis:

- A seasonal variable (categorizing an autotheft incidence as "Spring/ Summer" or "Fall/Winter")
- A day of the week variable (categorizing an autotheft incidence as "Weekday" or "Weekend") 
- A time of day variable (categorizing an autotheft incidence as "Day" or "Night")


## Question 1: 
Does the number of auto thefts show a significant correlation depending on whether it is a weekend vs a weekday?

```{r, echo=FALSE, warning=FALSE}
neighbourhood %>% 
  filter(!is.na(week_end_or_day)) %>%
  ggplot(aes(x = week_end_or_day)) + geom_bar()+
  ggtitle("Number of Auto Thefts based on Weekdays vs Weekends")+
  labs (x = "Weekday vs Weekends", y = "Number of Auto Thefts")
```

## Question 1 Results

- [INSERT RESULTS]


## Question 2:
Does the number of autothefts show a significant correlation depending on whether it is during the day or the night?

```{r, echo=FALSE, warning=FALSE}
neighbourhood %>% 
  filter(!is.na(time_of_day)) %>%
  ggplot(aes(x = time_of_day)) + geom_bar()+
  ggtitle("Number of Autothefts based on Daytime vs Nighttime")+
  labs(x= "Daytime vs Nighttime", y= "Number of Autothefts")
```

## Question 2 Results

- [INSERT RESULTS]

## Question 3:
Does the number of autothefts show a significant correlation depending on whether it is during the Spring/Summer or Winter/Fall?

```{r echo=FALSE, warning=FALSE}
neighbourhood %>%
  filter(!is.na(season))%>%
  ggplot(aes(x = season))+geom_bar()+
  ggtitle("Number of Autothefts based on Spring/Summer and Fall/Winter")+
  labs (x = "Spring/Summer vs Fall/Winter", y = "Number of Autothefts")
```

## Question 3 Results

- [INSERT RESULTS]


## Results

Present the main results here, in order of importance, related to the questions asked. You might use tables or graphs, or other ways to summarize your results.

## Conclusion

Give your main conclusions here. Follow the order of questions you presented. 

Here you can also mention any additional considerations, concerns, or issues you might have. For example, if the results were unexpected, you can discuss this and perhaps offer possible explanations.

## Acknowledgements (optional)

If you received any help from someone other than your team members you can acknowledge them. For example:   
*The authors would like to thank "TA name" for helpful suggestions and comments that improved the presentation of this poster.*

```{r}
#simulation for tiem of week
n <- 18178 
repetitions <- 1000
sim <- rep(NA, repetitions)
set.seed(1071)
for (i in 1:repetitions) {
  sim_weekday_or_end <- sample(c("Weekday", "Weekend"),
       size = n,
       prob = c(5/7, 2/7),
       replace = TRUE) 
  sim_p <- sum(sim_weekday_or_end == "Weekday") / n
  sim[i] <- sim_p
}
#build a plot with simulated data
sim <- data_frame(p_weekdays = sim)
sim %>% ggplot(aes(x = p_weekdays)) +
  geom_histogram(binwidth = 0.001, bins = 30, colour = "black", fill = "grey") +
  labs(x = "Proportion weekdays in 18178 days" )
```

```{r}
#time of week
neighbourhood %>% filter(!is.na(week_end_or_day))%>%
  summarise(n(),
            n_weekday = sum(week_end_or_day == "Weekday"),
            prop_weekday = n_weekday / n()) 
```

```{r}
#p_hat for day of week
13167/(13167+5008)
#     = 0.7244567
#test statistic
      5/7 - (0.7243371 - 5/7)
#     = 0.7042343
#p-value
      sim %>% filter(p_weekdays >= 0.7244567 | p_weekdays <= 0.7042343) %>%
        summarise(p_value = n() / repetitions)
#     = 0.004
```

```{r}
#simulation for time of day
n <- 18178
repetitions <- 1000
sim <- rep(NA, repetitions)
set.seed(1071)
for (i in 1:repetitions) {
  sim_time_of_day <- sample(c("Day", "Night"),
       size = n,
       prob = c(0.5, 0.5),
       replace = TRUE) 
  sim_p <- sum(sim_time_of_day == "Day") / n
  sim[i] <- sim_p
}
#build a plot with simulated data
sim <- data_frame(p_day = sim)
ggplot(sim, aes(p_day)) +
  geom_histogram(binwidth = 0.001, colour = "black", fill = "grey") + labs(x = "Proportion day time in 18178 days" )
```

```{r}
#results for time of day
neighbourhood %>% filter(!is.na(time_of_day))%>%
  summarise(n(),
            n_daytime = sum(time_of_day == "Day"),
            prop = n_daytime / n())
```

```{r}
#p_hat for time of day
6509/(18178)
#     = 0.3580702
#test statistic
      0.5 - (0.3580702 - 0.5/7)
#     = 0.2133584
#p-value
      sim %>% filter(p_day >= 0.3580702 | p_day <= 0.2133584) %>%
        summarise(p_value = n() / repetitions)
#     = 0.004
```
